# Git 进阶：rebase、cherry-pick 与工作流实践

日常开发中，`git add/commit/push` 已经不够用了。团队协作、分支管理、代码回溯，这些场景需要更多 Git 高级操作。本文记录我常用的进阶技巧。

## rebase vs merge

两者都能合并分支，但效果不同：

- **merge**：保留完整的分支历史，产生一个合并 commit
- **rebase**：把当前分支的 commit "搬到" 目标分支的最新位置，历史更线性

```bash
# merge 方式
git checkout main
git merge feature

# rebase 方式
git checkout feature
git rebase main
git checkout main
git merge feature  # fast-forward
```

**什么时候用 rebase？** 个人开发分支、还没推送到远程的 commit。已经推送过的公共分支不要 rebase，会改变历史导致冲突。

## cherry-pick：精确挑选 commit

有时只需要另一个分支的某个 commit，而不是整个分支：

```bash
git cherry-pick <commit-hash>

# 挑选多个
git cherry-pick abc123 def456

# 只暂存不提交
git cherry-pick --no-commit <hash>
```

典型场景：hotfix 分支修了一个 bug，需要同步到 develop 分支。

## stash：临时保存工作

写代码写到一半需要切分支？stash 帮你暂存：

```bash
git stash                    # 暂存
git stash save "WIP: login"  # 带名字
git stash list               # 查看所有
git stash pop                # 恢复最近的
git stash apply stash@{1}    # 恢复指定的
git stash drop stash@{0}     # 删除指定的
```

## 交互式操作

```bash
# 修改最近几个 commit
git rebase -i HEAD~3

# 合并 commit (squash)
# 在编辑器中把 pick 改成 squash

# 修改 commit 信息
git commit --amend
```

## 团队工作流

我们团队目前用的是 **GitHub Flow**：

1. `main` 分支始终可部署
2. 新功能创建 `feature/xxx` 分支
3. 开发完成后提 PR
4. Code Review 通过后合并
5. 合并后删除 feature 分支

简单有效，适合小团队快速迭代。

## 常用别名配置

```bash
git config --global alias.st status
git config --global alias.co checkout
git config --global alias.br branch
git config --global alias.lg "log --oneline --graph --all"
```

`git lg` 一行看清所有分支走向，推荐。

## 小结

Git 进阶操作的核心是理解 commit 是一个快照，分支是一个指针。掌握了这个心智模型，rebase、cherry-pick、reset 这些操作就很自然了。
